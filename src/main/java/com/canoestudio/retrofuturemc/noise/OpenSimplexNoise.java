package com.canoestudio.retrofuturemc.noise;

public class OpenSimplexNoise {
    private static final long PRIME_X = 5910200641878280303L;
    private static final long PRIME_Y = 6452764530575939509L;
    private static final long PRIME_Z = 6614699811220273867L;
    private static final long PRIME_W = 6254464313819354443L;
    private static final long HASH_MULTIPLIER = 6026932503003350773L;
    private static final long SEED_FLIP_3D = -5968755714895566377L;
    private static final double ROOT2OVER2 = 0.7071067811865476;
    private static final double SKEW_2D = 0.366025403784439;
    private static final double UNSKEW_2D = -0.21132486540518713;
    private static final double ROOT3OVER3 = 0.577350269189626;
    private static final double FALLBACK_ROTATE3 = 0.6666666666666666;
    private static final double ROTATE3_ORTHOGONALIZER = -0.21132486540518713;
    private static final float SKEW_4D = 0.309017F;
    private static final float UNSKEW_4D = -0.1381966F;
    private static final int N_GRADS_2D_EXPONENT = 7;
    private static final int N_GRADS_3D_EXPONENT = 8;
    private static final int N_GRADS_4D_EXPONENT = 9;
    private static final int N_GRADS_2D = 128;
    private static final int N_GRADS_3D = 256;
    private static final int N_GRADS_4D = 512;
    private static final double NORMALIZER_2D = 0.05481866495625118;
    private static final double NORMALIZER_3D = 0.2781926117527186;
    private static final double NORMALIZER_4D = 0.11127401889945551;
    private static final float RSQUARED_2D = 0.6666667F;
    private static final float RSQUARED_3D = 0.75F;
    private static final float RSQUARED_4D = 0.8F;
    private static float[] GRADIENTS_2D = new float[256];
    private static float[] GRADIENTS_3D;
    private static float[] GRADIENTS_4D;
    private static int[] LOOKUP_4D_A;
    private static LatticeVertex4D[] LOOKUP_4D_B;

    public static float noise2(long seed, double x, double y) {
        double s = 0.366025403784439 * (x + y);
        double xs = x + s;
        double ys = y + s;
        return noise2_UnskewedBase(seed, xs, ys);
    }

    public static float noise2_ImproveX(long seed, double x, double y) {
        double xx = x * 0.7071067811865476;
        double yy = y * 1.2247448713915896;
        return noise2_UnskewedBase(seed, yy + xx, yy - xx);
    }

    private static float noise2_UnskewedBase(long seed, double xs, double ys) {
        int xsb = fastFloor(xs);
        int ysb = fastFloor(ys);
        float xi = (float)(xs - (double)xsb);
        float yi = (float)(ys - (double)ysb);
        long xsbp = (long)xsb * 5910200641878280303L;
        long ysbp = (long)ysb * 6452764530575939509L;
        float t = (xi + yi) * -0.21132487F;
        float dx0 = xi + t;
        float dy0 = yi + t;
        float a0 = 0.6666667F - dx0 * dx0 - dy0 * dy0;
        float value = a0 * a0 * a0 * a0 * grad(seed, xsbp, ysbp, dx0, dy0);
        float a1 = -3.1547005F * t + -0.6666667F + a0;
        float dx1 = dx0 - 0.57735026F;
        float dy1 = dy0 - 0.57735026F;
        value += a1 * a1 * a1 * a1 * grad(seed, xsbp + 5910200641878280303L, ysbp + 6452764530575939509L, dx1, dy1);
        float xmyi = xi - yi;
        if ((double)t < -0.21132486540518713) {
            if (xi + xmyi > 1.0F) {
                float dx2 = dx0 - 1.3660254F;
                float dy2 = dy0 - 0.36602542F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp + -6626342789952991010L, ysbp + 6452764530575939509L, dx2, dy2);
                }
            } else {
                float dx2 = dx0 - -0.21132487F;
                float dy2 = dy0 - 0.7886751F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp, ysbp + 6452764530575939509L, dx2, dy2);
                }
            }

            if (yi - xmyi > 1.0F) {
                float dx3 = dx0 - 0.36602542F;
                float dy3 = dy0 - 1.3660254F;
                float a3 = 0.6666667F - dx3 * dx3 - dy3 * dy3;
                if (a3 > 0.0F) {
                    value += a3 * a3 * a3 * a3 * grad(seed, xsbp + 5910200641878280303L, ysbp + -5541215012557672598L, dx3, dy3);
                }
            } else {
                float dx3 = dx0 - 0.7886751F;
                float dy3 = dy0 - -0.21132487F;
                float a3 = 0.6666667F - dx3 * dx3 - dy3 * dy3;
                if (a3 > 0.0F) {
                    value += a3 * a3 * a3 * a3 * grad(seed, xsbp + 5910200641878280303L, ysbp, dx3, dy3);
                }
            }
        } else {
            if (xi + xmyi < 0.0F) {
                float dx2 = dx0 + 0.7886751F;
                float dy2 = dy0 + -0.21132487F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp - 5910200641878280303L, ysbp, dx2, dy2);
                }
            } else {
                float dx2 = dx0 - 0.7886751F;
                float dy2 = dy0 - -0.21132487F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp + 5910200641878280303L, ysbp, dx2, dy2);
                }
            }

            if (yi < xmyi) {
                float dx2 = dx0 + -0.21132487F;
                float dy2 = dy0 + 0.7886751F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp, ysbp - 6452764530575939509L, dx2, dy2);
                }
            } else {
                float dx2 = dx0 - -0.21132487F;
                float dy2 = dy0 - 0.7886751F;
                float a2 = 0.6666667F - dx2 * dx2 - dy2 * dy2;
                if (a2 > 0.0F) {
                    value += a2 * a2 * a2 * a2 * grad(seed, xsbp, ysbp + 6452764530575939509L, dx2, dy2);
                }
            }
        }

        return value;
    }

    public static float noise3_ImproveXY(long seed, double x, double y, double z) {
        double xy = x + y;
        double s2 = xy * -0.21132486540518713;
        double zz = z * 0.577350269189626;
        double xr = x + s2 + zz;
        double yr = y + s2 + zz;
        double zr = xy * -0.577350269189626 + zz;
        return noise3_UnrotatedBase(seed, xr, yr, zr);
    }

    public static float noise3_ImproveXZ(long seed, double x, double y, double z) {
        double xz = x + z;
        double s2 = xz * -0.211324865405187;
        double yy = y * 0.577350269189626;
        double xr = x + s2 + yy;
        double zr = z + s2 + yy;
        double yr = xz * -0.577350269189626 + yy;
        return noise3_UnrotatedBase(seed, xr, yr, zr);
    }

    public static float noise3_Fallback(long seed, double x, double y, double z) {
        double r = 0.6666666666666666 * (x + y + z);
        double xr = r - x;
        double yr = r - y;
        double zr = r - z;
        return noise3_UnrotatedBase(seed, xr, yr, zr);
    }

    private static float noise3_UnrotatedBase(long seed, double xr, double yr, double zr) {
        int xrb = fastFloor(xr);
        int yrb = fastFloor(yr);
        int zrb = fastFloor(zr);
        float xi = (float)(xr - (double)xrb);
        float yi = (float)(yr - (double)yrb);
        float zi = (float)(zr - (double)zrb);
        long xrbp = (long)xrb * 5910200641878280303L;
        long yrbp = (long)yrb * 6452764530575939509L;
        long zrbp = (long)zrb * 6614699811220273867L;
        long seed2 = seed ^ -5968755714895566377L;
        int xNMask = (int)(-0.5F - xi);
        int yNMask = (int)(-0.5F - yi);
        int zNMask = (int)(-0.5F - zi);
        float x0 = xi + (float)xNMask;
        float y0 = yi + (float)yNMask;
        float z0 = zi + (float)zNMask;
        float a0 = 0.75F - x0 * x0 - y0 * y0 - z0 * z0;
        float value = a0 * a0 * a0 * a0 * grad(seed, xrbp + ((long)xNMask & 5910200641878280303L), yrbp + ((long)yNMask & 6452764530575939509L), zrbp + ((long)zNMask & 6614699811220273867L), x0, y0, z0);
        float x1 = xi - 0.5F;
        float y1 = yi - 0.5F;
        float z1 = zi - 0.5F;
        float a1 = 0.75F - x1 * x1 - y1 * y1 - z1 * z1;
        value += a1 * a1 * a1 * a1 * grad(seed2, xrbp + 5910200641878280303L, yrbp + 6452764530575939509L, zrbp + 6614699811220273867L, x1, y1, z1);
        float xAFlipMask0 = (float)((xNMask | 1) << 1) * x1;
        float yAFlipMask0 = (float)((yNMask | 1) << 1) * y1;
        float zAFlipMask0 = (float)((zNMask | 1) << 1) * z1;
        float xAFlipMask1 = (float)(-2 - (xNMask << 2)) * x1 - 1.0F;
        float yAFlipMask1 = (float)(-2 - (yNMask << 2)) * y1 - 1.0F;
        float zAFlipMask1 = (float)(-2 - (zNMask << 2)) * z1 - 1.0F;
        boolean skip5 = false;
        float a2 = xAFlipMask0 + a0;
        if (a2 > 0.0F) {
            float x2 = x0 - (float)(xNMask | 1);
            value += a2 * a2 * a2 * a2 * grad(seed, xrbp + ((long)(~xNMask) & 5910200641878280303L), yrbp + ((long)yNMask & 6452764530575939509L), zrbp + ((long)zNMask & 6614699811220273867L), x2, y0, z0);
        } else {
            float a3 = yAFlipMask0 + zAFlipMask0 + a0;
            if (a3 > 0.0F) {
                float y3 = y0 - (float)(yNMask | 1);
                float z3 = z0 - (float)(zNMask | 1);
                value += a3 * a3 * a3 * a3 * grad(seed, xrbp + ((long)xNMask & 5910200641878280303L), yrbp + ((long)(~yNMask) & 6452764530575939509L), zrbp + ((long)(~zNMask) & 6614699811220273867L), x0, y3, z3);
            }

            float a4 = xAFlipMask1 + a1;
            if (a4 > 0.0F) {
                float x4 = (float)(xNMask | 1) + x1;
                value += a4 * a4 * a4 * a4 * grad(seed2, xrbp + ((long)xNMask & -6626342789952991010L), yrbp + 6452764530575939509L, zrbp + 6614699811220273867L, x4, y1, z1);
                skip5 = true;
            }
        }

        boolean skip9 = false;
        float a6 = yAFlipMask0 + a0;
        if (a6 > 0.0F) {
            float y6 = y0 - (float)(yNMask | 1);
            value += a6 * a6 * a6 * a6 * grad(seed, xrbp + ((long)xNMask & 5910200641878280303L), yrbp + ((long)(~yNMask) & 6452764530575939509L), zrbp + ((long)zNMask & 6614699811220273867L), x0, y6, z0);
        } else {
            float a7 = xAFlipMask0 + zAFlipMask0 + a0;
            if (a7 > 0.0F) {
                float x7 = x0 - (float)(xNMask | 1);
                float z7 = z0 - (float)(zNMask | 1);
                value += a7 * a7 * a7 * a7 * grad(seed, xrbp + ((long)(~xNMask) & 5910200641878280303L), yrbp + ((long)yNMask & 6452764530575939509L), zrbp + ((long)(~zNMask) & 6614699811220273867L), x7, y0, z7);
            }

            float a8 = yAFlipMask1 + a1;
            if (a8 > 0.0F) {
                float y8 = (float)(yNMask | 1) + y1;
                value += a8 * a8 * a8 * a8 * grad(seed2, xrbp + 5910200641878280303L, yrbp + ((long)yNMask & -5541215012557672598L), zrbp + 6614699811220273867L, x1, y8, z1);
                skip9 = true;
            }
        }

        boolean skipD = false;
        float aA = zAFlipMask0 + a0;
        if (aA > 0.0F) {
            float zA = z0 - (float)(zNMask | 1);
            value += aA * aA * aA * aA * grad(seed, xrbp + ((long)xNMask & 5910200641878280303L), yrbp + ((long)yNMask & 6452764530575939509L), zrbp + ((long)(~zNMask) & 6614699811220273867L), x0, y0, zA);
        } else {
            float aB = xAFlipMask0 + yAFlipMask0 + a0;
            if (aB > 0.0F) {
                float xB = x0 - (float)(xNMask | 1);
                float yB = y0 - (float)(yNMask | 1);
                value += aB * aB * aB * aB * grad(seed, xrbp + ((long)(~xNMask) & 5910200641878280303L), yrbp + ((long)(~yNMask) & 6452764530575939509L), zrbp + ((long)zNMask & 6614699811220273867L), xB, yB, z0);
            }

            float aC = zAFlipMask1 + a1;
            if (aC > 0.0F) {
                float zC = (float)(zNMask | 1) + z1;
                value += aC * aC * aC * aC * grad(seed2, xrbp + 5910200641878280303L, yrbp + 6452764530575939509L, zrbp + ((long)zNMask & -5217344451269003882L), x1, y1, zC);
                skipD = true;
            }
        }

        if (!skip5) {
            float a5 = yAFlipMask1 + zAFlipMask1 + a1;
            if (a5 > 0.0F) {
                float y5 = (float)(yNMask | 1) + y1;
                float z5 = (float)(zNMask | 1) + z1;
                value += a5 * a5 * a5 * a5 * grad(seed2, xrbp + 5910200641878280303L, yrbp + ((long)yNMask & -5541215012557672598L), zrbp + ((long)zNMask & -5217344451269003882L), x1, y5, z5);
            }
        }

        if (!skip9) {
            float a9 = xAFlipMask1 + zAFlipMask1 + a1;
            if (a9 > 0.0F) {
                float x9 = (float)(xNMask | 1) + x1;
                float z9 = (float)(zNMask | 1) + z1;
                value += a9 * a9 * a9 * a9 * grad(seed2, xrbp + ((long)xNMask & -6626342789952991010L), yrbp + 6452764530575939509L, zrbp + ((long)zNMask & -5217344451269003882L), x9, y1, z9);
            }
        }

        if (!skipD) {
            float aD = xAFlipMask1 + yAFlipMask1 + a1;
            if (aD > 0.0F) {
                float xD = (float)(xNMask | 1) + x1;
                float yD = (float)(yNMask | 1) + y1;
                value += aD * aD * aD * aD * grad(seed2, xrbp + ((long)xNMask & -6626342789952991010L), yrbp + ((long)yNMask & -5541215012557672598L), zrbp + 6614699811220273867L, xD, yD, z1);
            }
        }

        return value;
    }

    public static float noise4_ImproveXYZ_ImproveXY(long seed, double x, double y, double z, double w) {
        double xy = x + y;
        double s2 = xy * -0.211324865405187;
        double zz = z * 0.2886751345948129;
        double ww = w * 1.118033988749894;
        double xr = x + zz + ww + s2;
        double yr = y + zz + ww + s2;
        double zr = xy * -0.577350269189626 + zz + ww;
        double wr = z * -0.866025403784439 + ww;
        return noise4_UnskewedBase(seed, xr, yr, zr, wr);
    }

    public static float noise4_ImproveXYZ_ImproveXZ(long seed, double x, double y, double z, double w) {
        double xz = x + z;
        double s2 = xz * -0.211324865405187;
        double yy = y * 0.2886751345948129;
        double ww = w * 1.118033988749894;
        double xr = x + yy + ww + s2;
        double zr = z + yy + ww + s2;
        double yr = xz * -0.577350269189626 + yy + ww;
        double wr = y * -0.866025403784439 + ww;
        return noise4_UnskewedBase(seed, xr, yr, zr, wr);
    }

    public static float noise4_ImproveXYZ(long seed, double x, double y, double z, double w) {
        double xyz = x + y + z;
        double ww = w * 1.118033988749894;
        double s2 = xyz * -0.16666666666666666 + ww;
        double xs = x + s2;
        double ys = y + s2;
        double zs = z + s2;
        double ws = (double)-0.5F * xyz + ww;
        return noise4_UnskewedBase(seed, xs, ys, zs, ws);
    }

    public static float noise4_ImproveXY_ImproveZW(long seed, double x, double y, double z, double w) {
        double s2 = (x + y) * -0.2852251398743488 + (z + w) * 0.8389706547061143;
        double t2 = (z + w) * 0.21939749883706436 + (x + y) * -0.48214856493302477;
        double xs = x + s2;
        double ys = y + s2;
        double zs = z + t2;
        double ws = w + t2;
        return noise4_UnskewedBase(seed, xs, ys, zs, ws);
    }

    public static float noise4_Fallback(long seed, double x, double y, double z, double w) {
        double s = (double)0.309017F * (x + y + z + w);
        double xs = x + s;
        double ys = y + s;
        double zs = z + s;
        double ws = w + s;
        return noise4_UnskewedBase(seed, xs, ys, zs, ws);
    }

    private static float noise4_UnskewedBase(long seed, double xs, double ys, double zs, double ws) {
        int xsb = fastFloor(xs);
        int ysb = fastFloor(ys);
        int zsb = fastFloor(zs);
        int wsb = fastFloor(ws);
        float xsi = (float)(xs - (double)xsb);
        float ysi = (float)(ys - (double)ysb);
        float zsi = (float)(zs - (double)zsb);
        float wsi = (float)(ws - (double)wsb);
        float ssi = (xsi + ysi + zsi + wsi) * -0.1381966F;
        float xi = xsi + ssi;
        float yi = ysi + ssi;
        float zi = zsi + ssi;
        float wi = wsi + ssi;
        long xsvp = (long)xsb * 5910200641878280303L;
        long ysvp = (long)ysb * 6452764530575939509L;
        long zsvp = (long)zsb * 6614699811220273867L;
        long wsvp = (long)wsb * 6254464313819354443L;
        int index = (fastFloor(xs * (double)4.0F) & 3) << 0 | (fastFloor(ys * (double)4.0F) & 3) << 2 | (fastFloor(zs * (double)4.0F) & 3) << 4 | (fastFloor(ws * (double)4.0F) & 3) << 6;
        float value = 0.0F;
        int secondaryIndexStartAndStop = LOOKUP_4D_A[index];
        int secondaryIndexStart = secondaryIndexStartAndStop & '\uffff';
        int secondaryIndexStop = secondaryIndexStartAndStop >> 16;

        for(int i = secondaryIndexStart; i < secondaryIndexStop; ++i) {
            LatticeVertex4D c = LOOKUP_4D_B[i];
            float dx = xi + c.dx;
            float dy = yi + c.dy;
            float dz = zi + c.dz;
            float dw = wi + c.dw;
            float a = dx * dx + dy * dy + dz * dz + dw * dw;
            if (a < 0.8F) {
                a -= 0.8F;
                a *= a;
                value += a * a * grad(seed, xsvp + c.xsvp, ysvp + c.ysvp, zsvp + c.zsvp, wsvp + c.wsvp, dx, dy, dz, dw);
            }
        }

        return value;
    }

    private static float grad(long seed, long xsvp, long ysvp, float dx, float dy) {
        long hash = seed ^ xsvp ^ ysvp;
        hash *= 6026932503003350773L;
        hash ^= hash >> 58;
        int gi = (int)hash & 254;
        return GRADIENTS_2D[gi | 0] * dx + GRADIENTS_2D[gi | 1] * dy;
    }

    private static float grad(long seed, long xrvp, long yrvp, long zrvp, float dx, float dy, float dz) {
        long hash = seed ^ xrvp ^ yrvp ^ zrvp;
        hash *= 6026932503003350773L;
        hash ^= hash >> 58;
        int gi = (int)hash & 1020;
        return GRADIENTS_3D[gi | 0] * dx + GRADIENTS_3D[gi | 1] * dy + GRADIENTS_3D[gi | 2] * dz;
    }

    private static float grad(long seed, long xsvp, long ysvp, long zsvp, long wsvp, float dx, float dy, float dz, float dw) {
        long hash = seed ^ xsvp ^ ysvp ^ zsvp ^ wsvp;
        hash *= 6026932503003350773L;
        hash ^= hash >> 57;
        int gi = (int)hash & 2044;
        return GRADIENTS_4D[gi | 0] * dx + GRADIENTS_4D[gi | 1] * dy + GRADIENTS_4D[gi | 2] * dz + GRADIENTS_4D[gi | 3] * dw;
    }

    private static int fastFloor(double x) {
        int xi = (int)x;
        return x < (double)xi ? xi - 1 : xi;
    }

    static {
        float[] grad2 = new float[]{0.38268343F, 0.9238795F, 0.9238795F, 0.38268343F, 0.9238795F, -0.38268343F, 0.38268343F, -0.9238795F, -0.38268343F, -0.9238795F, -0.9238795F, -0.38268343F, -0.9238795F, 0.38268343F, -0.38268343F, 0.9238795F, 0.13052619F, 0.9914449F, 0.6087614F, 0.7933533F, 0.7933533F, 0.6087614F, 0.9914449F, 0.13052619F, 0.9914449F, -0.13052619F, 0.7933533F, -0.6087614F, 0.6087614F, -0.7933533F, 0.13052619F, -0.9914449F, -0.13052619F, -0.9914449F, -0.6087614F, -0.7933533F, -0.7933533F, -0.6087614F, -0.9914449F, -0.13052619F, -0.9914449F, 0.13052619F, -0.7933533F, 0.6087614F, -0.6087614F, 0.7933533F, -0.13052619F, 0.9914449F};

        for(int i = 0; i < grad2.length; ++i) {
            grad2[i] = (float)((double)grad2[i] / 0.05481866495625118);
        }

        int i = 0;

        for(int j = 0; i < GRADIENTS_2D.length; ++j) {
            if (j == grad2.length) {
                j = 0;
            }

            GRADIENTS_2D[i] = grad2[j];
            ++i;
        }

        GRADIENTS_3D = new float[1024];
        float[] grad3 = new float[]{2.2247448F, 2.2247448F, -1.0F, 0.0F, 2.2247448F, 2.2247448F, 1.0F, 0.0F, 3.0862665F, 1.1721513F, 0.0F, 0.0F, 1.1721513F, 3.0862665F, 0.0F, 0.0F, -2.2247448F, 2.2247448F, -1.0F, 0.0F, -2.2247448F, 2.2247448F, 1.0F, 0.0F, -1.1721513F, 3.0862665F, 0.0F, 0.0F, -3.0862665F, 1.1721513F, 0.0F, 0.0F, -1.0F, -2.2247448F, -2.2247448F, 0.0F, 1.0F, -2.2247448F, -2.2247448F, 0.0F, 0.0F, -3.0862665F, -1.1721513F, 0.0F, 0.0F, -1.1721513F, -3.0862665F, 0.0F, -1.0F, -2.2247448F, 2.2247448F, 0.0F, 1.0F, -2.2247448F, 2.2247448F, 0.0F, 0.0F, -1.1721513F, 3.0862665F, 0.0F, 0.0F, -3.0862665F, 1.1721513F, 0.0F, -2.2247448F, -2.2247448F, -1.0F, 0.0F, -2.2247448F, -2.2247448F, 1.0F, 0.0F, -3.0862665F, -1.1721513F, 0.0F, 0.0F, -1.1721513F, -3.0862665F, 0.0F, 0.0F, -2.2247448F, -1.0F, -2.2247448F, 0.0F, -2.2247448F, 1.0F, -2.2247448F, 0.0F, -1.1721513F, 0.0F, -3.0862665F, 0.0F, -3.0862665F, 0.0F, -1.1721513F, 0.0F, -2.2247448F, -1.0F, 2.2247448F, 0.0F, -2.2247448F, 1.0F, 2.2247448F, 0.0F, -3.0862665F, 0.0F, 1.1721513F, 0.0F, -1.1721513F, 0.0F, 3.0862665F, 0.0F, -1.0F, 2.2247448F, -2.2247448F, 0.0F, 1.0F, 2.2247448F, -2.2247448F, 0.0F, 0.0F, 1.1721513F, -3.0862665F, 0.0F, 0.0F, 3.0862665F, -1.1721513F, 0.0F, -1.0F, 2.2247448F, 2.2247448F, 0.0F, 1.0F, 2.2247448F, 2.2247448F, 0.0F, 0.0F, 3.0862665F, 1.1721513F, 0.0F, 0.0F, 1.1721513F, 3.0862665F, 0.0F, 2.2247448F, -2.2247448F, -1.0F, 0.0F, 2.2247448F, -2.2247448F, 1.0F, 0.0F, 1.1721513F, -3.0862665F, 0.0F, 0.0F, 3.0862665F, -1.1721513F, 0.0F, 0.0F, 2.2247448F, -1.0F, -2.2247448F, 0.0F, 2.2247448F, 1.0F, -2.2247448F, 0.0F, 3.0862665F, 0.0F, -1.1721513F, 0.0F, 1.1721513F, 0.0F, -3.0862665F, 0.0F, 2.2247448F, -1.0F, 2.2247448F, 0.0F, 2.2247448F, 1.0F, 2.2247448F, 0.0F, 1.1721513F, 0.0F, 3.0862665F, 0.0F, 3.0862665F, 0.0F, 1.1721513F, 0.0F};

        for(int i = 0; i < grad3.length; ++i) {
            grad3[i] = (float)((double)grad3[i] / 0.2781926117527186);
        }

        int i = 0;

        for(int j = 0; i < GRADIENTS_3D.length; ++j) {
            if (j == grad3.length) {
                j = 0;
            }

            GRADIENTS_3D[i] = grad3[j];
            ++i;
        }

        GRADIENTS_4D = new float[2048];
        float[] grad4 = new float[]{-0.6740059F, -0.32398477F, -0.32398477F, 0.5794685F, -0.7504884F, -0.40046722F, 0.15296486F, 0.502986F, -0.7504884F, 0.15296486F, -0.40046722F, 0.502986F, -0.8828162F, 0.08164729F, 0.08164729F, 0.4553054F, -0.4553054F, -0.08164729F, -0.08164729F, 0.8828162F, -0.502986F, -0.15296486F, 0.40046722F, 0.7504884F, -0.502986F, 0.40046722F, -0.15296486F, 0.7504884F, -0.5794685F, 0.32398477F, 0.32398477F, 0.6740059F, -0.6740059F, -0.32398477F, 0.5794685F, -0.32398477F, -0.7504884F, -0.40046722F, 0.502986F, 0.15296486F, -0.7504884F, 0.15296486F, 0.502986F, -0.40046722F, -0.8828162F, 0.08164729F, 0.4553054F, 0.08164729F, -0.4553054F, -0.08164729F, 0.8828162F, -0.08164729F, -0.502986F, -0.15296486F, 0.7504884F, 0.40046722F, -0.502986F, 0.40046722F, 0.7504884F, -0.15296486F, -0.5794685F, 0.32398477F, 0.6740059F, 0.32398477F, -0.6740059F, 0.5794685F, -0.32398477F, -0.32398477F, -0.7504884F, 0.502986F, -0.40046722F, 0.15296486F, -0.7504884F, 0.502986F, 0.15296486F, -0.40046722F, -0.8828162F, 0.4553054F, 0.08164729F, 0.08164729F, -0.4553054F, 0.8828162F, -0.08164729F, -0.08164729F, -0.502986F, 0.7504884F, -0.15296486F, 0.40046722F, -0.502986F, 0.7504884F, 0.40046722F, -0.15296486F, -0.5794685F, 0.6740059F, 0.32398477F, 0.32398477F, 0.5794685F, -0.6740059F, -0.32398477F, -0.32398477F, 0.502986F, -0.7504884F, -0.40046722F, 0.15296486F, 0.502986F, -0.7504884F, 0.15296486F, -0.40046722F, 0.4553054F, -0.8828162F, 0.08164729F, 0.08164729F, 0.8828162F, -0.4553054F, -0.08164729F, -0.08164729F, 0.7504884F, -0.502986F, -0.15296486F, 0.40046722F, 0.7504884F, -0.502986F, 0.40046722F, -0.15296486F, 0.6740059F, -0.5794685F, 0.32398477F, 0.32398477F, -0.753341F, -0.3796829F, -0.3796829F, -0.3796829F, -0.78216845F, -0.43214726F, -0.43214726F, 0.121284805F, -0.78216845F, -0.43214726F, 0.121284805F, -0.43214726F, -0.78216845F, 0.121284805F, -0.43214726F, -0.43214726F, -0.85865086F, -0.5086297F, 0.04480237F, 0.04480237F, -0.85865086F, 0.04480237F, -0.5086297F, 0.04480237F, -0.85865086F, 0.04480237F, 0.04480237F, -0.5086297F, -0.9982829F, -0.033819415F, -0.033819415F, -0.033819415F, -0.3796829F, -0.753341F, -0.3796829F, -0.3796829F, -0.43214726F, -0.78216845F, -0.43214726F, 0.121284805F, -0.43214726F, -0.78216845F, 0.121284805F, -0.43214726F, 0.121284805F, -0.78216845F, -0.43214726F, -0.43214726F, -0.5086297F, -0.85865086F, 0.04480237F, 0.04480237F, 0.04480237F, -0.85865086F, -0.5086297F, 0.04480237F, 0.04480237F, -0.85865086F, 0.04480237F, -0.5086297F, -0.033819415F, -0.9982829F, -0.033819415F, -0.033819415F, -0.3796829F, -0.3796829F, -0.753341F, -0.3796829F, -0.43214726F, -0.43214726F, -0.78216845F, 0.121284805F, -0.43214726F, 0.121284805F, -0.78216845F, -0.43214726F, 0.121284805F, -0.43214726F, -0.78216845F, -0.43214726F, -0.5086297F, 0.04480237F, -0.85865086F, 0.04480237F, 0.04480237F, -0.5086297F, -0.85865086F, 0.04480237F, 0.04480237F, 0.04480237F, -0.85865086F, -0.5086297F, -0.033819415F, -0.033819415F, -0.9982829F, -0.033819415F, -0.3796829F, -0.3796829F, -0.3796829F, -0.753341F, -0.43214726F, -0.43214726F, 0.121284805F, -0.78216845F, -0.43214726F, 0.121284805F, -0.43214726F, -0.78216845F, 0.121284805F, -0.43214726F, -0.43214726F, -0.78216845F, -0.5086297F, 0.04480237F, 0.04480237F, -0.85865086F, 0.04480237F, -0.5086297F, 0.04480237F, -0.85865086F, 0.04480237F, 0.04480237F, -0.5086297F, -0.85865086F, -0.033819415F, -0.033819415F, -0.033819415F, -0.9982829F, -0.32398477F, -0.6740059F, -0.32398477F, 0.5794685F, -0.40046722F, -0.7504884F, 0.15296486F, 0.502986F, 0.15296486F, -0.7504884F, -0.40046722F, 0.502986F, 0.08164729F, -0.8828162F, 0.08164729F, 0.4553054F, -0.08164729F, -0.4553054F, -0.08164729F, 0.8828162F, -0.15296486F, -0.502986F, 0.40046722F, 0.7504884F, 0.40046722F, -0.502986F, -0.15296486F, 0.7504884F, 0.32398477F, -0.5794685F, 0.32398477F, 0.6740059F, -0.32398477F, -0.32398477F, -0.6740059F, 0.5794685F, -0.40046722F, 0.15296486F, -0.7504884F, 0.502986F, 0.15296486F, -0.40046722F, -0.7504884F, 0.502986F, 0.08164729F, 0.08164729F, -0.8828162F, 0.4553054F, -0.08164729F, -0.08164729F, -0.4553054F, 0.8828162F, -0.15296486F, 0.40046722F, -0.502986F, 0.7504884F, 0.40046722F, -0.15296486F, -0.502986F, 0.7504884F, 0.32398477F, 0.32398477F, -0.5794685F, 0.6740059F, -0.32398477F, -0.6740059F, 0.5794685F, -0.32398477F, -0.40046722F, -0.7504884F, 0.502986F, 0.15296486F, 0.15296486F, -0.7504884F, 0.502986F, -0.40046722F, 0.08164729F, -0.8828162F, 0.4553054F, 0.08164729F, -0.08164729F, -0.4553054F, 0.8828162F, -0.08164729F, -0.15296486F, -0.502986F, 0.7504884F, 0.40046722F, 0.40046722F, -0.502986F, 0.7504884F, -0.15296486F, 0.32398477F, -0.5794685F, 0.6740059F, 0.32398477F, -0.32398477F, -0.32398477F, 0.5794685F, -0.6740059F, -0.40046722F, 0.15296486F, 0.502986F, -0.7504884F, 0.15296486F, -0.40046722F, 0.502986F, -0.7504884F, 0.08164729F, 0.08164729F, 0.4553054F, -0.8828162F, -0.08164729F, -0.08164729F, 0.8828162F, -0.4553054F, -0.15296486F, 0.40046722F, 0.7504884F, -0.502986F, 0.40046722F, -0.15296486F, 0.7504884F, -0.502986F, 0.32398477F, 0.32398477F, 0.6740059F, -0.5794685F, -0.32398477F, 0.5794685F, -0.6740059F, -0.32398477F, -0.40046722F, 0.502986F, -0.7504884F, 0.15296486F, 0.15296486F, 0.502986F, -0.7504884F, -0.40046722F, 0.08164729F, 0.4553054F, -0.8828162F, 0.08164729F, -0.08164729F, 0.8828162F, -0.4553054F, -0.08164729F, -0.15296486F, 0.7504884F, -0.502986F, 0.40046722F, 0.40046722F, 0.7504884F, -0.502986F, -0.15296486F, 0.32398477F, 0.6740059F, -0.5794685F, 0.32398477F, -0.32398477F, 0.5794685F, -0.32398477F, -0.6740059F, -0.40046722F, 0.502986F, 0.15296486F, -0.7504884F, 0.15296486F, 0.502986F, -0.40046722F, -0.7504884F, 0.08164729F, 0.4553054F, 0.08164729F, -0.8828162F, -0.08164729F, 0.8828162F, -0.08164729F, -0.4553054F, -0.15296486F, 0.7504884F, 0.40046722F, -0.502986F, 0.40046722F, 0.7504884F, -0.15296486F, -0.502986F, 0.32398477F, 0.6740059F, 0.32398477F, -0.5794685F, 0.5794685F, -0.32398477F, -0.6740059F, -0.32398477F, 0.502986F, -0.40046722F, -0.7504884F, 0.15296486F, 0.502986F, 0.15296486F, -0.7504884F, -0.40046722F, 0.4553054F, 0.08164729F, -0.8828162F, 0.08164729F, 0.8828162F, -0.08164729F, -0.4553054F, -0.08164729F, 0.7504884F, -0.15296486F, -0.502986F, 0.40046722F, 0.7504884F, 0.40046722F, -0.502986F, -0.15296486F, 0.6740059F, 0.32398477F, -0.5794685F, 0.32398477F, 0.5794685F, -0.32398477F, -0.32398477F, -0.6740059F, 0.502986F, -0.40046722F, 0.15296486F, -0.7504884F, 0.502986F, 0.15296486F, -0.40046722F, -0.7504884F, 0.4553054F, 0.08164729F, 0.08164729F, -0.8828162F, 0.8828162F, -0.08164729F, -0.08164729F, -0.4553054F, 0.7504884F, -0.15296486F, 0.40046722F, -0.502986F, 0.7504884F, 0.40046722F, -0.15296486F, -0.502986F, 0.6740059F, 0.32398477F, 0.32398477F, -0.5794685F, 0.033819415F, 0.033819415F, 0.033819415F, 0.9982829F, -0.04480237F, -0.04480237F, 0.5086297F, 0.85865086F, -0.04480237F, 0.5086297F, -0.04480237F, 0.85865086F, -0.121284805F, 0.43214726F, 0.43214726F, 0.78216845F, 0.5086297F, -0.04480237F, -0.04480237F, 0.85865086F, 0.43214726F, -0.121284805F, 0.43214726F, 0.78216845F, 0.43214726F, 0.43214726F, -0.121284805F, 0.78216845F, 0.3796829F, 0.3796829F, 0.3796829F, 0.753341F, 0.033819415F, 0.033819415F, 0.9982829F, 0.033819415F, -0.04480237F, 0.04480237F, 0.85865086F, 0.5086297F, -0.04480237F, 0.5086297F, 0.85865086F, -0.04480237F, -0.121284805F, 0.43214726F, 0.78216845F, 0.43214726F, 0.5086297F, -0.04480237F, 0.85865086F, -0.04480237F, 0.43214726F, -0.121284805F, 0.78216845F, 0.43214726F, 0.43214726F, 0.43214726F, 0.78216845F, -0.121284805F, 0.3796829F, 0.3796829F, 0.753341F, 0.3796829F, 0.033819415F, 0.9982829F, 0.033819415F, 0.033819415F, -0.04480237F, 0.85865086F, -0.04480237F, 0.5086297F, -0.04480237F, 0.85865086F, 0.5086297F, -0.04480237F, -0.121284805F, 0.78216845F, 0.43214726F, 0.43214726F, 0.5086297F, 0.85865086F, -0.04480237F, -0.04480237F, 0.43214726F, 0.78216845F, -0.121284805F, 0.43214726F, 0.43214726F, 0.78216845F, 0.43214726F, -0.121284805F, 0.3796829F, 0.753341F, 0.3796829F, 0.3796829F, 0.9982829F, 0.033819415F, 0.033819415F, 0.033819415F, 0.85865086F, -0.04480237F, -0.04480237F, 0.5086297F, 0.85865086F, -0.04480237F, 0.5086297F, -0.04480237F, 0.78216845F, -0.121284805F, 0.43214726F, 0.43214726F, 0.85865086F, 0.5086297F, -0.04480237F, -0.04480237F, 0.78216845F, 0.43214726F, -0.121284805F, 0.43214726F, 0.78216845F, 0.43214726F, 0.43214726F, -0.121284805F, 0.753341F, 0.3796829F, 0.3796829F, 0.3796829F};

        for(int i = 0; i < grad4.length; ++i) {
            grad4[i] = (float)((double)grad4[i] / 0.11127401889945551);
        }

        int i = 0;

        for(int j = 0; i < GRADIENTS_4D.length; ++j) {
            if (j == grad4.length) {
                j = 0;
            }

            GRADIENTS_4D[i] = grad4[j];
            ++i;
        }

        int[][] lookup4DVertexCodes = new int[][]{{21, 69, 81, 84, 85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170}, {21, 69, 81, 85, 86, 89, 90, 101, 102, 106, 149, 150, 154, 166, 170}, {1, 5, 17, 21, 65, 69, 81, 85, 86, 90, 102, 106, 150, 154, 166, 170}, {1, 21, 22, 69, 70, 81, 82, 85, 86, 90, 102, 106, 150, 154, 166, 170, 171}, {21, 69, 84, 85, 86, 89, 90, 101, 105, 106, 149, 153, 154, 169, 170}, {5, 21, 69, 85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 170}, {5, 21, 69, 85, 86, 89, 90, 102, 106, 150, 154, 170}, {5, 21, 22, 69, 70, 85, 86, 89, 90, 102, 106, 150, 154, 170, 171}, {4, 5, 20, 21, 68, 69, 84, 85, 89, 90, 105, 106, 153, 154, 169, 170}, {5, 21, 69, 85, 86, 89, 90, 105, 106, 153, 154, 170}, {5, 21, 69, 85, 86, 89, 90, 106, 154, 170}, {5, 21, 22, 69, 70, 85, 86, 89, 90, 91, 106, 154, 170, 171}, {4, 21, 25, 69, 73, 84, 85, 88, 89, 90, 105, 106, 153, 154, 169, 170, 174}, {5, 21, 25, 69, 73, 85, 86, 89, 90, 105, 106, 153, 154, 170, 174}, {5, 21, 25, 69, 73, 85, 86, 89, 90, 94, 106, 154, 170, 174}, {5, 21, 26, 69, 74, 85, 86, 89, 90, 91, 94, 106, 154, 170, 171, 174, 175}, {21, 81, 84, 85, 86, 89, 101, 102, 105, 106, 149, 165, 166, 169, 170}, {17, 21, 81, 85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 165, 166, 170}, {17, 21, 81, 85, 86, 90, 101, 102, 106, 150, 166, 170}, {17, 21, 22, 81, 82, 85, 86, 90, 101, 102, 106, 150, 166, 170, 171}, {20, 21, 84, 85, 86, 89, 90, 101, 102, 105, 106, 149, 153, 165, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 149, 154, 166, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 150, 154, 166, 170, 171}, {21, 22, 85, 86, 90, 102, 106, 107, 150, 154, 166, 170, 171}, {20, 21, 84, 85, 89, 90, 101, 105, 106, 153, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 153, 154, 169, 170, 174}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 154, 170}, {21, 22, 85, 86, 89, 90, 102, 106, 107, 154, 170, 171}, {20, 21, 25, 84, 85, 88, 89, 90, 101, 105, 106, 153, 169, 170, 174}, {21, 25, 85, 89, 90, 105, 106, 110, 153, 154, 169, 170, 174}, {21, 25, 85, 86, 89, 90, 105, 106, 110, 154, 170, 174}, {21, 26, 85, 86, 89, 90, 106, 107, 110, 154, 170, 171, 174, 175}, {16, 17, 20, 21, 80, 81, 84, 85, 101, 102, 105, 106, 165, 166, 169, 170}, {17, 21, 81, 85, 86, 101, 102, 105, 106, 165, 166, 170}, {17, 21, 81, 85, 86, 101, 102, 106, 166, 170}, {17, 21, 22, 81, 82, 85, 86, 101, 102, 103, 106, 166, 170, 171}, {20, 21, 84, 85, 89, 101, 102, 105, 106, 165, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 166, 170}, {21, 22, 85, 86, 90, 101, 102, 106, 107, 166, 170, 171}, {20, 21, 84, 85, 89, 101, 105, 106, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 170}, {21, 22, 85, 86, 89, 90, 101, 102, 105, 106, 107, 170, 171}, {20, 21, 25, 84, 85, 88, 89, 101, 105, 106, 109, 169, 170, 174}, {21, 25, 85, 89, 90, 101, 105, 106, 110, 169, 170, 174}, {21, 25, 85, 86, 89, 90, 101, 102, 105, 106, 110, 170, 174}, {21, 85, 86, 89, 90, 102, 105, 106, 107, 110, 154, 170, 171, 174, 175}, {16, 21, 37, 81, 84, 85, 97, 100, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {17, 21, 37, 81, 85, 86, 97, 101, 102, 105, 106, 165, 166, 170, 186}, {17, 21, 37, 81, 85, 86, 97, 101, 102, 106, 118, 166, 170, 186}, {17, 21, 38, 81, 85, 86, 98, 101, 102, 103, 106, 118, 166, 170, 171, 186, 187}, {20, 21, 37, 84, 85, 89, 100, 101, 102, 105, 106, 165, 169, 170, 186}, {21, 37, 85, 101, 102, 105, 106, 122, 165, 166, 169, 170, 186}, {21, 37, 85, 86, 101, 102, 105, 106, 122, 166, 170, 186}, {21, 38, 85, 86, 101, 102, 106, 107, 122, 166, 170, 171, 186, 187}, {20, 21, 37, 84, 85, 89, 100, 101, 105, 106, 121, 169, 170, 186}, {21, 37, 85, 89, 101, 102, 105, 106, 122, 169, 170, 186}, {21, 37, 85, 86, 89, 90, 101, 102, 105, 106, 122, 170, 186}, {21, 85, 86, 90, 101, 102, 105, 106, 107, 122, 166, 170, 171, 186, 187}, {20, 21, 41, 84, 85, 89, 101, 104, 105, 106, 109, 121, 169, 170, 174, 186, 190}, {21, 41, 85, 89, 101, 105, 106, 110, 122, 169, 170, 174, 186, 190}, {21, 85, 89, 90, 101, 102, 105, 106, 110, 122, 169, 170, 174, 186, 190}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 107, 110, 122, 170, 171, 174, 186, 191}, {69, 81, 84, 85, 86, 89, 101, 149, 150, 153, 154, 165, 166, 169, 170}, {65, 69, 81, 85, 86, 89, 90, 101, 102, 149, 150, 153, 154, 165, 166, 170}, {65, 69, 81, 85, 86, 90, 102, 149, 150, 154, 166, 170}, {65, 69, 70, 81, 82, 85, 86, 90, 102, 149, 150, 154, 166, 170, 171}, {68, 69, 84, 85, 86, 89, 90, 101, 105, 149, 150, 153, 154, 165, 169, 170}, {69, 85, 86, 89, 90, 101, 106, 149, 150, 153, 154, 166, 169, 170}, {69, 85, 86, 89, 90, 102, 106, 149, 150, 153, 154, 166, 170, 171}, {69, 70, 85, 86, 90, 102, 106, 150, 154, 155, 166, 170, 171}, {68, 69, 84, 85, 89, 90, 105, 149, 153, 154, 169, 170}, {69, 85, 86, 89, 90, 105, 106, 149, 150, 153, 154, 169, 170, 174}, {69, 85, 86, 89, 90, 106, 149, 150, 153, 154, 170}, {69, 70, 85, 86, 89, 90, 106, 150, 154, 155, 170, 171}, {68, 69, 73, 84, 85, 88, 89, 90, 105, 149, 153, 154, 169, 170, 174}, {69, 73, 85, 89, 90, 105, 106, 153, 154, 158, 169, 170, 174}, {69, 73, 85, 86, 89, 90, 106, 153, 154, 158, 170, 174}, {69, 74, 85, 86, 89, 90, 106, 154, 155, 158, 170, 171, 174, 175}, {80, 81, 84, 85, 86, 89, 101, 102, 105, 149, 150, 153, 165, 166, 169, 170}, {81, 85, 86, 89, 101, 102, 106, 149, 150, 154, 165, 166, 169, 170}, {81, 85, 86, 90, 101, 102, 106, 149, 150, 154, 165, 166, 170, 171}, {81, 82, 85, 86, 90, 102, 106, 150, 154, 166, 167, 170, 171}, {84, 85, 86, 89, 101, 105, 106, 149, 153, 154, 165, 166, 169, 170}, {85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170}, {21, 69, 81, 85, 86, 89, 90, 101, 102, 106, 149, 150, 154, 166, 170, 171}, {85, 86, 90, 102, 106, 150, 154, 166, 170, 171}, {84, 85, 89, 90, 101, 105, 106, 149, 153, 154, 165, 169, 170, 174}, {21, 69, 84, 85, 86, 89, 90, 101, 105, 106, 149, 153, 154, 169, 170, 174}, {21, 69, 85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 166, 169, 170, 171, 174}, {85, 86, 89, 90, 102, 106, 150, 154, 166, 170, 171}, {84, 85, 88, 89, 90, 105, 106, 153, 154, 169, 170, 173, 174}, {85, 89, 90, 105, 106, 153, 154, 169, 170, 174}, {85, 86, 89, 90, 105, 106, 153, 154, 169, 170, 174}, {85, 86, 89, 90, 106, 154, 170, 171, 174, 175}, {80, 81, 84, 85, 101, 102, 105, 149, 165, 166, 169, 170}, {81, 85, 86, 101, 102, 105, 106, 149, 150, 165, 166, 169, 170, 186}, {81, 85, 86, 101, 102, 106, 149, 150, 165, 166, 170}, {81, 82, 85, 86, 101, 102, 106, 150, 166, 167, 170, 171}, {84, 85, 89, 101, 102, 105, 106, 149, 153, 165, 166, 169, 170, 186}, {21, 81, 84, 85, 86, 89, 101, 102, 105, 106, 149, 165, 166, 169, 170, 186}, {21, 81, 85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 154, 165, 166, 169, 170, 171, 186}, {85, 86, 90, 101, 102, 106, 150, 154, 166, 170, 171}, {84, 85, 89, 101, 105, 106, 149, 153, 165, 169, 170}, {21, 84, 85, 86, 89, 90, 101, 102, 105, 106, 149, 153, 154, 165, 166, 169, 170, 174, 186}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 154, 166, 169, 170}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 150, 154, 166, 170, 171}, {84, 85, 88, 89, 101, 105, 106, 153, 169, 170, 173, 174}, {85, 89, 90, 101, 105, 106, 153, 154, 169, 170, 174}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 153, 154, 169, 170, 174}, {21, 85, 86, 89, 90, 102, 105, 106, 154, 170, 171, 174, 175}, {80, 81, 84, 85, 97, 100, 101, 102, 105, 149, 165, 166, 169, 170, 186}, {81, 85, 97, 101, 102, 105, 106, 165, 166, 169, 170, 182, 186}, {81, 85, 86, 97, 101, 102, 106, 165, 166, 170, 182, 186}, {81, 85, 86, 98, 101, 102, 106, 166, 167, 170, 171, 182, 186, 187}, {84, 85, 100, 101, 102, 105, 106, 165, 166, 169, 170, 185, 186}, {85, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {85, 86, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {85, 86, 101, 102, 106, 166, 170, 171, 186, 187}, {84, 85, 89, 100, 101, 105, 106, 165, 169, 170, 185, 186}, {85, 89, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {21, 85, 86, 89, 90, 101, 102, 105, 106, 165, 166, 169, 170, 186}, {21, 85, 86, 90, 101, 102, 105, 106, 166, 170, 171, 186, 187}, {84, 85, 89, 101, 104, 105, 106, 169, 170, 173, 174, 185, 186, 190}, {85, 89, 101, 105, 106, 169, 170, 174, 186, 190}, {21, 85, 89, 90, 101, 102, 105, 106, 169, 170, 174, 186, 190}, {85, 86, 89, 90, 101, 102, 105, 106, 170, 171, 174, 186, 191}, {64, 65, 68, 69, 80, 81, 84, 85, 149, 150, 153, 154, 165, 166, 169, 170}, {65, 69, 81, 85, 86, 149, 150, 153, 154, 165, 166, 170}, {65, 69, 81, 85, 86, 149, 150, 154, 166, 170}, {65, 69, 70, 81, 82, 85, 86, 149, 150, 151, 154, 166, 170, 171}, {68, 69, 84, 85, 89, 149, 150, 153, 154, 165, 169, 170}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 166, 170}, {69, 70, 85, 86, 90, 149, 150, 154, 155, 166, 170, 171}, {68, 69, 84, 85, 89, 149, 153, 154, 169, 170}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 169, 170}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 170}, {69, 70, 85, 86, 89, 90, 149, 150, 153, 154, 155, 170, 171}, {68, 69, 73, 84, 85, 88, 89, 149, 153, 154, 157, 169, 170, 174}, {69, 73, 85, 89, 90, 149, 153, 154, 158, 169, 170, 174}, {69, 73, 85, 86, 89, 90, 149, 150, 153, 154, 158, 170, 174}, {69, 85, 86, 89, 90, 106, 150, 153, 154, 155, 158, 170, 171, 174, 175}, {80, 81, 84, 85, 101, 149, 150, 153, 165, 166, 169, 170}, {81, 85, 86, 101, 102, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {81, 85, 86, 101, 102, 149, 150, 154, 165, 166, 170}, {81, 82, 85, 86, 102, 149, 150, 154, 166, 167, 170, 171}, {84, 85, 89, 101, 105, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {69, 81, 84, 85, 86, 89, 101, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {69, 81, 85, 86, 89, 90, 101, 102, 106, 149, 150, 153, 154, 165, 166, 169, 170, 171, 234}, {85, 86, 90, 102, 106, 149, 150, 154, 166, 170, 171}, {84, 85, 89, 101, 105, 149, 153, 154, 165, 169, 170}, {69, 84, 85, 86, 89, 90, 101, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170, 174, 234}, {69, 85, 86, 89, 90, 106, 149, 150, 153, 154, 166, 169, 170}, {69, 85, 86, 89, 90, 102, 106, 149, 150, 153, 154, 166, 170, 171}, {84, 85, 88, 89, 105, 149, 153, 154, 169, 170, 173, 174}, {85, 89, 90, 105, 106, 149, 153, 154, 169, 170, 174}, {69, 85, 86, 89, 90, 105, 106, 149, 150, 153, 154, 169, 170, 174}, {69, 85, 86, 89, 90, 106, 150, 153, 154, 170, 171, 174, 175}, {80, 81, 84, 85, 101, 149, 165, 166, 169, 170}, {81, 85, 86, 101, 102, 149, 150, 165, 166, 169, 170}, {81, 85, 86, 101, 102, 149, 150, 165, 166, 170}, {81, 82, 85, 86, 101, 102, 149, 150, 165, 166, 167, 170, 171}, {84, 85, 89, 101, 105, 149, 153, 165, 166, 169, 170}, {81, 84, 85, 86, 89, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170, 186, 234}, {81, 85, 86, 101, 102, 106, 149, 150, 154, 165, 166, 169, 170}, {81, 85, 86, 90, 101, 102, 106, 149, 150, 154, 165, 166, 170, 171}, {84, 85, 89, 101, 105, 149, 153, 165, 169, 170}, {84, 85, 89, 101, 105, 106, 149, 153, 154, 165, 166, 169, 170}, {85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170}, {85, 86, 89, 90, 101, 102, 106, 149, 150, 154, 166, 169, 170, 171}, {84, 85, 88, 89, 101, 105, 149, 153, 165, 169, 170, 173, 174}, {84, 85, 89, 90, 101, 105, 106, 149, 153, 154, 165, 169, 170, 174}, {85, 86, 89, 90, 101, 105, 106, 149, 153, 154, 166, 169, 170, 174}, {85, 86, 89, 90, 102, 105, 106, 150, 153, 154, 166, 169, 170, 171, 174, 175}, {80, 81, 84, 85, 97, 100, 101, 149, 165, 166, 169, 170, 181, 186}, {81, 85, 97, 101, 102, 149, 165, 166, 169, 170, 182, 186}, {81, 85, 86, 97, 101, 102, 149, 150, 165, 166, 170, 182, 186}, {81, 85, 86, 101, 102, 106, 150, 165, 166, 167, 170, 171, 182, 186, 187}, {84, 85, 100, 101, 105, 149, 165, 166, 169, 170, 185, 186}, {85, 101, 102, 105, 106, 149, 165, 166, 169, 170, 186}, {81, 85, 86, 101, 102, 105, 106, 149, 150, 165, 166, 169, 170, 186}, {81, 85, 86, 101, 102, 106, 150, 165, 166, 170, 171, 186, 187}, {84, 85, 89, 100, 101, 105, 149, 153, 165, 169, 170, 185, 186}, {84, 85, 89, 101, 102, 105, 106, 149, 153, 165, 166, 169, 170, 186}, {85, 86, 89, 101, 102, 105, 106, 149, 154, 165, 166, 169, 170, 186}, {85, 86, 90, 101, 102, 105, 106, 150, 154, 165, 166, 169, 170, 171, 186, 187}, {84, 85, 89, 101, 105, 106, 153, 165, 169, 170, 173, 174, 185, 186, 190}, {84, 85, 89, 101, 105, 106, 153, 165, 169, 170, 174, 186, 190}, {85, 89, 90, 101, 102, 105, 106, 153, 154, 165, 166, 169, 170, 174, 186, 190}, {85, 86, 89, 90, 101, 102, 105, 106, 154, 166, 169, 170, 171, 174, 186}, {64, 69, 81, 84, 85, 133, 145, 148, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {65, 69, 81, 85, 86, 133, 145, 149, 150, 153, 154, 165, 166, 170, 234}, {65, 69, 81, 85, 86, 133, 145, 149, 150, 154, 166, 170, 214, 234}, {65, 69, 81, 85, 86, 134, 146, 149, 150, 151, 154, 166, 170, 171, 214, 234, 235}, {68, 69, 84, 85, 89, 133, 148, 149, 150, 153, 154, 165, 169, 170, 234}, {69, 85, 133, 149, 150, 153, 154, 165, 166, 169, 170, 218, 234}, {69, 85, 86, 133, 149, 150, 153, 154, 166, 170, 218, 234}, {69, 85, 86, 134, 149, 150, 154, 155, 166, 170, 171, 218, 234, 235}, {68, 69, 84, 85, 89, 133, 148, 149, 153, 154, 169, 170, 217, 234}, {69, 85, 89, 133, 149, 150, 153, 154, 169, 170, 218, 234}, {69, 85, 86, 89, 90, 133, 149, 150, 153, 154, 170, 218, 234}, {69, 85, 86, 90, 149, 150, 153, 154, 155, 166, 170, 171, 218, 234, 235}, {68, 69, 84, 85, 89, 137, 149, 152, 153, 154, 157, 169, 170, 174, 217, 234, 238}, {69, 85, 89, 137, 149, 153, 154, 158, 169, 170, 174, 218, 234, 238}, {69, 85, 89, 90, 149, 150, 153, 154, 158, 169, 170, 174, 218, 234, 238}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 155, 158, 170, 171, 174, 218, 234, 239}, {80, 81, 84, 85, 101, 145, 148, 149, 150, 153, 165, 166, 169, 170, 234}, {81, 85, 145, 149, 150, 153, 154, 165, 166, 169, 170, 230, 234}, {81, 85, 86, 145, 149, 150, 154, 165, 166, 170, 230, 234}, {81, 85, 86, 146, 149, 150, 154, 166, 167, 170, 171, 230, 234, 235}, {84, 85, 148, 149, 150, 153, 154, 165, 166, 169, 170, 233, 234}, {85, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {85, 86, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {85, 86, 149, 150, 154, 166, 170, 171, 234, 235}, {84, 85, 89, 148, 149, 153, 154, 165, 169, 170, 233, 234}, {85, 89, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {69, 85, 86, 89, 90, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {69, 85, 86, 90, 149, 150, 153, 154, 166, 170, 171, 234, 235}, {84, 85, 89, 149, 152, 153, 154, 169, 170, 173, 174, 233, 234, 238}, {85, 89, 149, 153, 154, 169, 170, 174, 234, 238}, {69, 85, 89, 90, 149, 150, 153, 154, 169, 170, 174, 234, 238}, {85, 86, 89, 90, 149, 150, 153, 154, 170, 171, 174, 234, 239}, {80, 81, 84, 85, 101, 145, 148, 149, 165, 166, 169, 170, 229, 234}, {81, 85, 101, 145, 149, 150, 165, 166, 169, 170, 230, 234}, {81, 85, 86, 101, 102, 145, 149, 150, 165, 166, 170, 230, 234}, {81, 85, 86, 102, 149, 150, 154, 165, 166, 167, 170, 171, 230, 234, 235}, {84, 85, 101, 148, 149, 153, 165, 166, 169, 170, 233, 234}, {85, 101, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {81, 85, 86, 101, 102, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {81, 85, 86, 102, 149, 150, 154, 165, 166, 170, 171, 234, 235}, {84, 85, 89, 101, 105, 148, 149, 153, 165, 169, 170, 233, 234}, {84, 85, 89, 101, 105, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {85, 86, 89, 101, 106, 149, 150, 153, 154, 165, 166, 169, 170, 234}, {85, 86, 90, 102, 106, 149, 150, 153, 154, 165, 166, 169, 170, 171, 234, 235}, {84, 85, 89, 105, 149, 153, 154, 165, 169, 170, 173, 174, 233, 234, 238}, {84, 85, 89, 105, 149, 153, 154, 165, 169, 170, 174, 234, 238}, {85, 89, 90, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170, 174, 234, 238}, {85, 86, 89, 90, 106, 149, 150, 153, 154, 166, 169, 170, 171, 174, 234}, {80, 81, 84, 85, 101, 149, 161, 164, 165, 166, 169, 170, 181, 186, 229, 234, 250}, {81, 85, 101, 149, 161, 165, 166, 169, 170, 182, 186, 230, 234, 250}, {81, 85, 101, 102, 149, 150, 165, 166, 169, 170, 182, 186, 230, 234, 250}, {81, 85, 86, 101, 102, 149, 150, 165, 166, 167, 170, 171, 182, 186, 230, 234, 251}, {84, 85, 101, 149, 164, 165, 166, 169, 170, 185, 186, 233, 234, 250}, {85, 101, 149, 165, 166, 169, 170, 186, 234, 250}, {81, 85, 101, 102, 149, 150, 165, 166, 169, 170, 186, 234, 250}, {85, 86, 101, 102, 149, 150, 165, 166, 170, 171, 186, 234, 251}, {84, 85, 101, 105, 149, 153, 165, 166, 169, 170, 185, 186, 233, 234, 250}, {84, 85, 101, 105, 149, 153, 165, 166, 169, 170, 186, 234, 250}, {85, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170, 186, 234, 250}, {85, 86, 101, 102, 106, 149, 150, 154, 165, 166, 169, 170, 171, 186, 234}, {84, 85, 89, 101, 105, 149, 153, 165, 169, 170, 173, 174, 185, 186, 233, 234, 254}, {85, 89, 101, 105, 149, 153, 165, 169, 170, 174, 186, 234, 254}, {85, 89, 101, 105, 106, 149, 153, 154, 165, 166, 169, 170, 174, 186, 234}, {85, 86, 89, 90, 101, 102, 105, 106, 149, 150, 153, 154, 165, 166, 169, 170, 171, 174, 186, 234}};
        LatticeVertex4D[] latticeVerticesByCode = new LatticeVertex4D[256];

        for(int i = 0; i < 256; ++i) {
            int cx = (i >> 0 & 3) - 1;
            int cy = (i >> 2 & 3) - 1;
            int cz = (i >> 4 & 3) - 1;
            int cw = (i >> 6 & 3) - 1;
            latticeVerticesByCode[i] = new LatticeVertex4D(cx, cy, cz, cw);
        }

        int nLatticeVerticesTotal = 0;

        for(int i = 0; i < 256; ++i) {
            nLatticeVerticesTotal += lookup4DVertexCodes[i].length;
        }

        LOOKUP_4D_A = new int[256];
        LOOKUP_4D_B = new LatticeVertex4D[nLatticeVerticesTotal];
        int i = 0;

        for(int j = 0; i < 256; ++i) {
            LOOKUP_4D_A[i] = j | j + lookup4DVertexCodes[i].length << 16;

            for(int k = 0; k < lookup4DVertexCodes[i].length; ++k) {
                LOOKUP_4D_B[j++] = latticeVerticesByCode[lookup4DVertexCodes[i][k]];
            }
        }

    }

    private static class LatticeVertex4D {
        public final float dx;
        public final float dy;
        public final float dz;
        public final float dw;
        public final long xsvp;
        public final long ysvp;
        public final long zsvp;
        public final long wsvp;

        public LatticeVertex4D(int xsv, int ysv, int zsv, int wsv) {
            this.xsvp = (long)xsv * 5910200641878280303L;
            this.ysvp = (long)ysv * 6452764530575939509L;
            this.zsvp = (long)zsv * 6614699811220273867L;
            this.wsvp = (long)wsv * 6254464313819354443L;
            float ssv = (float)(xsv + ysv + zsv + wsv) * -0.1381966F;
            this.dx = (float)(-xsv) - ssv;
            this.dy = (float)(-ysv) - ssv;
            this.dz = (float)(-zsv) - ssv;
            this.dw = (float)(-wsv) - ssv;
        }
    }
}